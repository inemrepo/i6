
<% block('localCSS', '<link rel="stylesheet" href="/plugins/datatables/datatables.min.css">') %>

<% block('localScripts', '<script src="/plugins/datatables/datatables.min.js"></script>') %>

<!-- FLOT CHARTS -->
<!-- FLOT RESIZE PLUGIN - allows the chart to redraw when the window is resized -->
<% block('localScripts', '<script src="/adm/bower_components/Flot/jquery.flot.js"></script>') %>
<!-- FLOT PIE PLUGIN - also used to draw donut charts -->
<% block('localScripts', '<script src="/adm/bower_components/Flot/jquery.flot.resize.js"></script>') %>
<% block('localScripts', '<script src="/adm/bower_components/Flot/jquery.flot.time.js"></script>') %>
<!-- FLOT CATEGORIES PLUGIN - Used to draw bar charts -->
<% block('localScripts', '<script src="/adm/bower_components/Flot/jquery.flot.categories.js"></script>') %>
<!-- FLOT CATEGORIES PLUGIN - Used to draw bar charts -->
<% block('localScripts', '<script src="/adm/bower_components/Flot/jquery.flot.crosshair.js"></script>') %>


<script type="text/javascript">
    function onViewLoaded(){
        $(function() {
            var sin = [], cos = [];
            for (var i = 0; i < 14; i += 0.1) {
                sin.push([i, Math.sin(i)]);
                cos.push([i, Math.cos(i)]);
            }
            plot = $.plot("#placeholder", [
                { data: sin, label: "sin(x) = -0.00"},
                { data: cos, label: "cos(x) = -0.00" }
            ], {
                series: {
                    lines: {
                        show: true
                    }
                },
                crosshair: {
                    mode: "x"
                },
                grid: {
                    hoverable: true,
                    autoHighlight: false
                },
                yaxis: {
                    min: -1.2,
                    max: 1.2
                }
            });
            var legends = $("#placeholder .legendLabel");
            legends.each(function () {
                // fix the widths so they don't jump around
                $(this).css('width', $(this).width());
            });
            var updateLegendTimeout = null;
            var latestPosition = null;
            function updateLegend() {
                updateLegendTimeout = null;
                var pos = latestPosition;
                var axes = plot.getAxes();
                if (pos.x < axes.xaxis.min || pos.x > axes.xaxis.max ||
                    pos.y < axes.yaxis.min || pos.y > axes.yaxis.max) {
                    return;
                }
                var i, j, dataset = plot.getData();
                for (i = 0; i < dataset.length; ++i) {
                    var series = dataset[i];
                    // Find the nearest points, x-wise
                    for (j = 0; j < series.data.length; ++j) {
                        if (series.data[j][0] > pos.x) {
                            break;
                        }
                    }
                    // Now Interpolate
                    var y,x,
                        p1 = series.data[j - 1],
                        p2 = series.data[j];
                    if (p1 == null) {
                        y = p2[1];
                        x = p2[0];
                    } else if (p2 == null) {
                        y = p1[1];
                        x = p1[0];
                    } else {
                        y = p1[1] + (p2[1] - p1[1]) * (pos.x - p1[0]) / (p2[0] - p1[0]);
                        x = p1[0];
                    }
                    legends.eq(i).text(series.label.replace(/=.*/, "= " + y.toFixed(2)));
                    $('.lg'+ i ).html(y.toFixed(2));
                    console.log(i + ' : ' + y.toFixed(2));
                    console.log(x + ' : ' + x.toFixed(2));
                }
            }
            $("#placeholder").bind("plothover",  function (event, pos, item) {
                latestPosition = pos;
                if (!updateLegendTimeout) {
                    updateLegendTimeout = setTimeout(updateLegend, 50);
                }
            });
        });
    }
	</script>


<div class="row">
    <div class="col-md-12">
        <div class="box">
            <div class="box-header">

            </div>
            <div class="box-body">
                <div id="placeholder" class="demo-placeholder" style="height:400px; width:100%"></div>                    
            </div>
            <div class="box-footer">
                <table class="table table-striped table-bordered">
                    <thead>
                        <tr>
                            <th></th>
                            <th>Tag</th>
                            <th>Description</th>
                            <th>Value</th>
                            <th>Unit</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td></td>
                            <td>Sin</td>
                            <td></td>
                            <td class="lg0"></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>Cos</td>
                            <td></td>
                            <td class="lg1"></td>
                            <td></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>